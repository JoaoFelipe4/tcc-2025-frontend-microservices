<section class="hero">
  <div class="container">
    <div class="hero-content">
      <h1>Encontre Seu M√©dico</h1>
      <p>Agende consultas com os melhores profissionais de sa√∫de.</p>
      <div class="hero-actions">
        <a routerLink="/sobre" class="btn btn-primary">Saiba Mais</a>
        <a routerLink="/login" class="btn btn-secondary">Fazer Login</a>
      </div>
    </div>
  </div>
</section>

<section class="doctors">
  <div class="container">
    <h2>Nossos M√©dicos</h2>
    
    <!-- Filters Section -->
    <div class="filters" *ngIf="!loading && !error">
      <div class="filter-group">
        <label for="specialtyFilter">Filtrar por Especialidade:</label>
        <select id="specialtyFilter" [(ngModel)]="selectedSpecialty" (change)="applyFilters()">
          <option value="">Todas as especialidades</option>
          <option *ngFor="let specialty of specialties" [value]="specialty">{{ specialty }}</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="availabilityFilter">Disponibilidade:</label>
        <select id="availabilityFilter" [(ngModel)]="availabilityFilter" (change)="applyFilters()">
          <option value="all">Todos os m√©dicos</option>
          <option value="true">Aceitando pacientes</option>
          <option value="false">N√£o aceitando pacientes</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="limitFilter">M√©dicos por p√°gina:</label>
        <select id="limitFilter" [(ngModel)]="limit" (change)="applyFilters()">
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </div>

      <div class="filter-group search-group">
        <label for="searchFilter">Buscar por nome:</label>
        <input 
          type="text" 
          id="searchFilter" 
          placeholder="Digite o nome do m√©dico..."
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()">
      </div>

      <button class="btn btn-primary" (click)="clearFilters()">Limpar Filtros</button>
    </div>

    <!-- Results Info -->
    <div class="results-info" *ngIf="!loading && !error && doctors.length > 0">
      <p>
        Mostrando {{ displayedDoctors.length }} de {{ totalDoctors }} m√©dico(s)
        <span *ngIf="selectedSpecialty"> - Especialidade: {{ selectedSpecialty }}</span>
        <span *ngIf="availabilityFilter !== 'all'"> - {{ availabilityFilter === 'true' ? 'Dispon√≠veis' : 'Indispon√≠veis' }}</span>
        <span *ngIf="searchTerm"> - Nome: "{{ searchTerm }}"</span>
      </p>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading">
      <p>Carregando m√©dicos...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error">
      <p>{{ error }}</p>
      <button (click)="loadDoctors()" class="btn btn-primary">Tentar Novamente</button>
    </div>

    <!-- Doctors Grid -->
    <div class="doctors-grid" *ngIf="!loading && !error && displayedDoctors.length > 0">
      <div class="doctor-card" *ngFor="let doctor of displayedDoctors">
        <div class="doctor-icon">üë®‚Äç‚öïÔ∏è</div>
        <h3>Dr. {{ doctor.user.firstName }} {{ doctor.user.lastName }}</h3>
        <p><strong>CRM:</strong> {{ doctor.crm }}</p>
        <p><strong>Especialidade:</strong> {{ doctor.specialties.join(', ') }}</p>
        <p><strong>Consulta:</strong> R$ {{ doctor.consultationPrice }}</p>
        <p><strong>Dura√ß√£o:</strong> {{ doctor.consultationDuration }}min</p>
        <div class="doctor-status" [class.available]="doctor.isAcceptingPatients">
          {{ doctor.isAcceptingPatients ? 'üü¢ Aceitando Pacientes' : 'üî¥ Lotado' }}
        </div>
        <button class="btn btn-primary" (click)="schedule(doctor)">
          Agendar Consulta
        </button>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="!loading && !error && displayedDoctors.length > 0 && totalPages > 1 && !searchTerm">
      <button 
        class="btn btn-primary" 
        [disabled]="currentPage === 1"
        (click)="changePage(currentPage - 1)">
        Anterior
      </button>
      
      <span class="page-info">
        P√°gina {{ currentPage }} de {{ totalPages }}
      </span>
      
      <button 
        class="btn btn-primary" 
        [disabled]="currentPage === totalPages"
        (click)="changePage(currentPage + 1)">
        Pr√≥xima
      </button>
    </div>

    <!-- Empty State after searching -->
    <div *ngIf="!loading && !error && displayedDoctors.length === 0 && doctors.length > 0" class="empty-state">
      <p>Nenhum m√©dico encontrado com o nome "{{ searchTerm }}".</p>
      <button class="btn btn-primary" (click)="clearSearch()">Limpar Busca</button>
    </div>

    <!-- Empty State no doctors -->
    <div *ngIf="!loading && !error && doctors.length === 0" class="empty-state">
      <p>Nenhum m√©dico dispon√≠vel no momento.</p>
    </div>
  </div>
</section>